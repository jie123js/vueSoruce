{"code":"import { extend, isObject } from \"@vue/shared\";\r\nimport { track, trigger } from \"./effect\";\r\nimport { reactive, readonly } from \"./reactive\";\r\nconst get = createGetter();\r\nconst readonlyGet = createGetter(true);\r\nconst shallowGet = createGetter(false, true);\r\nconst shallowReadonlyGet = createGetter(true, true);\r\nconst set = createSetter();\r\nconst readonlySet = {\r\n    set(target, key) {\r\n        console.warn(`cannot set on ${key},readonly`);\r\n    },\r\n};\r\nfunction createSetter() {\r\n    return function set(target, key, value, reactiver) {\r\n        //value是设置值,其他是一样的\r\n        //Reflect.xxx都会有布尔值的返回值\r\n        let res = Reflect.set(target, key, value, reactiver); //等价于 target[key]=value\r\n        console.log(\"设置值\", key, value);\r\n        //触发更新逻辑\r\n        trigger(target, key, value);\r\n        return res; //本来这个语法就是要返回一个true的  然后Reflect.xxx都会有布尔值的返回值\r\n    };\r\n}\r\nfunction createGetter(isReadonly = false, shallow = false) {\r\n    return function get(target, key, reactiver) {\r\n        let res = Reflect.get(target, key, reactiver); //todo 这2个写法等价 target[key]\r\n        //procy一般和reflect联合使用\r\n        if (!isReadonly) {\r\n            //如果对象是一个仅读的属性,那么意味着对象不可能被更改,也就不会更新试图,不需要增添依赖收集\r\n            //不是仅读的才去收集依赖\r\n            track(target, \"get\", key);\r\n        }\r\n        console.log(target[key]);\r\n        if (shallow) {\r\n            //如果是浅代理就不用递归了\r\n            return res;\r\n        }\r\n        //这个就是 取值了才会去递归 不会一上来就把对象里面包对象的值全部递归,这就是vue3比2好的一些地方\r\n        //  return isReadonly ? readonly(res) : reactive(res); //懒代理,只有取值的时候才会去代理\r\n        //!下面这样写会好理解一点,但是没必要,因为前面已经判断过是不是对象了\r\n        if (isObject(res)) {\r\n            //如果是对象就递归代理,但是不是一开始就代理,是用到了再代理\r\n            return isReadonly ? readonly(res) : reactive(res);\r\n        }\r\n        return res;\r\n    };\r\n}\r\nexport const mutableHandlers = {\r\n    get: get,\r\n    set,\r\n};\r\nexport const shallowReactiveHandlers = {\r\n    get: shallowGet,\r\n    set,\r\n};\r\nexport const readonlyHandlers = extend({\r\n    get: readonlyGet,\r\n}, readonlySet);\r\nexport const shallowReadonlyHandlers = extend({\r\n    get: shallowReadonlyGet,\r\n}, readonlySet);\r\n//# sourceMappingURL=baseHandlers.js.map","references":["C:/Users/ZJcoder/Desktop/vue源码/vueSoruce/11、vue3/packages/shared/src/index.ts","C:/Users/ZJcoder/Desktop/vue源码/vueSoruce/11、vue3/packages/reactivity/src/effect.ts","C:/Users/ZJcoder/Desktop/vue源码/vueSoruce/11、vue3/packages/reactivity/src/reactive.ts"],"map":"{\"version\":3,\"file\":\"baseHandlers.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/baseHandlers.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,aAAa,CAAC;AAC/C,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,UAAU,CAAC;AAC1C,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAEhD,MAAM,GAAG,GAAG,YAAY,EAAE,CAAC;AAC3B,MAAM,WAAW,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;AACvC,MAAM,UAAU,GAAG,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;AAC7C,MAAM,kBAAkB,GAAG,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AAEpD,MAAM,GAAG,GAAG,YAAY,EAAE,CAAC;AAE3B,MAAM,WAAW,GAAG;IAClB,GAAG,CAAC,MAAM,EAAE,GAAG;QACb,OAAO,CAAC,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC,CAAC;IAChD,CAAC;CACF,CAAC;AACF,SAAS,YAAY;IACnB,OAAO,SAAS,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,SAAS;QAC/C,kBAAkB;QAClB,uBAAuB;QACvB,IAAI,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC,CAAC,uBAAuB;QAC7E,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;QAC/B,QAAQ;QACR,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;QAC5B,OAAO,GAAG,CAAC,CAAC,6CAA6C;IAC3D,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,YAAY,CAAC,UAAU,GAAG,KAAK,EAAE,OAAO,GAAG,KAAK;IACvD,OAAO,SAAS,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,SAAS;QACxC,IAAI,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,EAAE,SAAS,CAAC,CAAC,CAAC,0BAA0B;QACzE,qBAAqB;QACrB,IAAI,CAAC,UAAU,EAAE;YACf,+CAA+C;YAC/C,aAAa;YACb,KAAK,CAAC,MAAM,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;SAC3B;QACD,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;QAEzB,IAAI,OAAO,EAAE;YACX,cAAc;YACd,OAAO,GAAG,CAAC;SACZ;QACD,oDAAoD;QAEpD,yEAAyE;QAEzE,oCAAoC;QACpC,IAAI,QAAQ,CAAC,GAAG,CAAC,EAAE;YACjB,+BAA+B;YAC/B,OAAO,UAAU,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;SACnD;QAED,OAAO,GAAG,CAAC;IACb,CAAC,CAAC;AACJ,CAAC;AAED,MAAM,CAAC,MAAM,eAAe,GAAG;IAC7B,GAAG,EAAE,GAAG;IACR,GAAG;CACJ,CAAC;AAEF,MAAM,CAAC,MAAM,uBAAuB,GAAG;IACrC,GAAG,EAAE,UAAU;IACf,GAAG;CACJ,CAAC;AAEF,MAAM,CAAC,MAAM,gBAAgB,GAAG,MAAM,CACpC;IACE,GAAG,EAAE,WAAW;CACjB,EACD,WAAW,CACZ,CAAC;AAEF,MAAM,CAAC,MAAM,uBAAuB,GAAG,MAAM,CAC3C;IACE,GAAG,EAAE,kBAAkB;CACxB,EACD,WAAW,CACZ,CAAC\"}"}
