{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n  return typeof val === \"function\";\r\n}\r\nexport function isObject(val) {\r\n  return typeof val == \"object\" && val !== null;\r\n}\r\n","import { isObject } from \"../utils\";\r\n\r\nclass Observe {\r\n  constructor(value) {\r\n    this.walk(value);\r\n  }\r\n  walk(data) {\r\n    //todo 循环对象的key且不要原型上面的key\r\n    Object.keys(data).forEach((key) => {\r\n      defineReactive(data, key, data[key]);\r\n    });\r\n  }\r\n}\r\nfunction defineReactive(obj, key, value) {\r\n  //todo data里面嵌套对象的话递归调用(这个是vue2性能差的一个原因)\r\n  observe(value);\r\n  //todo 这是一个闭包这个value不能被销毁\r\n  Object.defineProperty(obj, key, {\r\n    get() {\r\n      return value;\r\n    },\r\n    set(newValue) {\r\n      if ((newValue = value)) {\r\n        return;\r\n      }\r\n      value = newValue;\r\n    },\r\n  });\r\n}\r\nexport function observe(value) {\r\n  //console.log(value);\r\n  //   if(!isObject(value){\r\n  //       return\r\n  //   }\r\n  if (!isObject(value)) {\r\n    return;\r\n  }\r\n  return new Observe(value);\r\n}\r\n","import { observe } from \"./observe\";\r\nimport { isFunction } from \"./utils\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction initData(vm) {\r\n  //console.log(\"初始化vm\");\r\n  let data = vm.$options.data;\r\n  //如果data写的是函数this指向是window所以我们需要用call重置\r\n  data = isFunction(data) ? data.call(vm) : data;\r\n\r\n  observe(data);\r\n  //console.log(data);\r\n}\r\n","import { initState } from \"./state\";\r\n\r\nexport function _initMax(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this;\r\n    //console.log(this);//todo实例对象\r\n    vm.$options = options;\r\n    initState(vm); //初始化\r\n    if (options.el) {\r\n      // console.log(options.el);\r\n    }\r\n  };\r\n}\r\n","import { _initMax } from \"./init\";\r\n//todo new Vue的时候先做一个初始化操作_init,但是需要先在实例的prototype上挂一个_init方法,这个步骤在_initMax中实现\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\n_initMax(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["isFunction","val","isObject","Observe","constructor","value","walk","data","Object","keys","forEach","key","defineReactive","obj","observe","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","call","_initMax","Vue","prototype","_init","options","el"],"mappings":";;;;;;EAAO,SAASA,UAAT,CAAoBC,GAApB,EAAyB;EAC9B,SAAO,OAAOA,GAAP,KAAe,UAAtB;EACD;EACM,SAASC,QAAT,CAAkBD,GAAlB,EAAuB;EAC5B,SAAO,OAAOA,GAAP,IAAc,QAAd,IAA0BA,GAAG,KAAK,IAAzC;EACD;;ECHD,MAAME,OAAN,CAAc;EACZC,EAAAA,WAAW,CAACC,KAAD,EAAQ;EACjB,SAAKC,IAAL,CAAUD,KAAV;EACD;;EACDC,EAAAA,IAAI,CAACC,IAAD,EAAO;EACT;EACAC,IAAAA,MAAM,CAACC,IAAP,CAAYF,IAAZ,EAAkBG,OAAlB,CAA2BC,GAAD,IAAS;EACjCC,MAAAA,cAAc,CAACL,IAAD,EAAOI,GAAP,EAAYJ,IAAI,CAACI,GAAD,CAAhB,CAAd;EACD,KAFD;EAGD;;EATW;;EAWd,SAASC,cAAT,CAAwBC,GAAxB,EAA6BF,GAA7B,EAAkCN,KAAlC,EAAyC;EACvC;EACAS,EAAAA,OAAO,CAACT,KAAD,CAAP,CAFuC;;EAIvCG,EAAAA,MAAM,CAACO,cAAP,CAAsBF,GAAtB,EAA2BF,GAA3B,EAAgC;EAC9BK,IAAAA,GAAG,GAAG;EACJ,aAAOX,KAAP;EACD,KAH6B;;EAI9BY,IAAAA,GAAG,CAACC,QAAD,EAAW;EACZ,UAAKA,QAAQ,GAAGb,KAAhB,EAAwB;EACtB;EACD;;EACDA,MAAAA,KAAK,GAAGa,QAAR;EACD;;EAT6B,GAAhC;EAWD;;EACM,SAASJ,OAAT,CAAiBT,KAAjB,EAAwB;EAC7B;EACA;EACA;EACA;EACA,MAAI,CAACH,QAAQ,CAACG,KAAD,CAAb,EAAsB;EACpB;EACD;;EACD,SAAO,IAAIF,OAAJ,CAAYE,KAAZ,CAAP;EACD;;ECnCM,SAASc,SAAT,CAAmBC,EAAnB,EAAuB;EAC5B,QAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB;;EACA,MAAID,IAAI,CAACd,IAAT,EAAe;EACbgB,IAAAA,QAAQ,CAACH,EAAD,CAAR;EACD;EACF;;EAED,SAASG,QAAT,CAAkBH,EAAlB,EAAsB;EACpB;EACA,MAAIb,IAAI,GAAGa,EAAE,CAACE,QAAH,CAAYf,IAAvB,CAFoB;;EAIpBA,EAAAA,IAAI,GAAGP,UAAU,CAACO,IAAD,CAAV,GAAmBA,IAAI,CAACiB,IAAL,CAAUJ,EAAV,CAAnB,GAAmCb,IAA1C;EAEAO,EAAAA,OAAO,CAACP,IAAD,CAAP,CANoB;EAQrB;;EChBM,SAASkB,QAAT,CAAkBC,GAAlB,EAAuB;EAC5BA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAAUC,OAAV,EAAmB;EACvC,UAAMT,EAAE,GAAG,IAAX,CADuC;;EAGvCA,IAAAA,EAAE,CAACE,QAAH,GAAcO,OAAd;EACAV,IAAAA,SAAS,CAACC,EAAD,CAAT,CAJuC;;EAKvC,QAAIS,OAAO,CAACC,EAAZ,EAAgB;EAGjB,GARD;EASD;;ECVD,SAASJ,GAAT,CAAaG,OAAb,EAAsB;EACpB,OAAKD,KAAL,CAAWC,OAAX;EACD;;EACDJ,QAAQ,CAACC,GAAD,CAAR;;;;;;;;"}